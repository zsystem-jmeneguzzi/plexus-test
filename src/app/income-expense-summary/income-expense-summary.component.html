<div class="main-wrapper">
  <app-header [ngClass]="{'d-none': sideBarActivePath === false && headerActivePath === false}"></app-header>
  <app-sidebar [ngClass]="{'d-none': sideBarActivePath === false && headerActivePath === false}"></app-sidebar>
  <div class="page-wrapper">
    <div class="content">
      <div class="row">
        <div class="col-sm-12">
          <h2>Resumen de Ingresos, Egresos y Deudas</h2>
          <div class="row">
            <div class="col-12">
              <!-- Filtros -->
              <div class="row">
                <div class="col-12 col-md-6 col-xl-3 form-group">
                  <label for="carpeta">Nombre de la Carpeta</label>
                  <input type="text" id="carpeta" [(ngModel)]="filtroCarpeta" class="form-control">
                </div>
                <div class="col-12 col-md-6 col-xl-3 form-group">
                  <label for="fechaInicio">Fecha de Inicio</label>
                  <input type="date" id="fechaInicio" [(ngModel)]="filtroFechaInicio" class="form-control">
                </div>
                <div class="col-12 col-md-6 col-xl-3 form-group">
                  <label for="fechaFin">Fecha de Fin</label>
                  <input type="date" id="fechaFin" [(ngModel)]="filtroFechaFin" class="form-control">
                </div>
                <div class="col-12 col-md-6 col-xl-3 form-group">
                  <button (click)="aplicarFiltros()" class="btn btn-primary">Aplicar Filtros</button>
                  <button (click)="limpiarFiltros()" class="btn btn-secondary">Limpiar Filtros</button>
                </div>
              </div>
              <!-- Agregar Ingreso, Egreso, y Deuda -->
              <div class="row">
                <div class="col-12 col-md-4 form-group">
                  <label for="concepto">Concepto:</label>
                  <input type="text" id="concepto" [(ngModel)]="concepto" class="form-control">
                </div>
                <div class="col-12 col-md-4 form-group">
                  <label for="monto">Monto:</label>
                  <input type="number" id="monto" [(ngModel)]="monto" class="form-control">
                </div>
                <div class="col-12 col-md-4 form-group">
                  <label for="tipo">Tipo:</label>
                  <select id="tipo" [(ngModel)]="tipo" class="form-control">
                    <option value="ingreso">Ingreso</option>
                    <option value="egreso">Egreso</option>
                    <!-- <option value="deuda">Deuda</option> -->
                  </select>
                </div>
                <div class="col-12 text-center">
                  <button (click)="agregarIngresoEgresoDeuda()" class="btn btn-success mt-2">Agregar</button>
                </div>
              </div>
              <!-- Tabla de Ingresos, Egresos y Deudas -->
              <div class="col-sm-12">
                <div class="card">
                  <div class="card-body">
                    <table class="table">
                      <thead>
                          <tr>
                              <th>Fecha</th>
                              <th>Autos</th>
                              <th>Concepto</th>
                              <th>Ingreso</th>
                              <th>Egreso</th>
                              <th>Deuda</th>
                              <th></th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr *ngFor="let item of ingresosEgresosDeudasFiltrados; let i = index">
                              <td>{{ item.fecha | date:'dd/MM/yyyy' }}</td>
                              <td>{{ item.autos }}</td> <!-- Asegúrate de que esta línea esté correctamente apuntando a item.autos -->
                              <td>{{ item.concepto }}</td>
                              <td>{{ item.tipo === 'ingreso' ? (item.monto | currency) : '' }}</td>
                              <td>{{ item.tipo === 'egreso' ? (item.monto | currency) : '' }}</td>
                              <td>{{ item.tipo === 'deuda' ? (item.monto | currency) : '' }}</td>
                              <td>
                                  <button (click)="eliminarIngresoEgresoDeuda(i)" class="btn btn-danger btn-sm">X</button>
                              </td>
                          </tr>
                      </tbody>
                      <tfoot>
                          <tr>
                              <td colspan="3" class="text-end">Subtotal Ingresos:</td>
                              <td>{{ subtotalIngresos | currency }}</td>
                              <td></td>
                              <td></td>
                          </tr>
                          <tr>
                              <td colspan="3" class="text-end">Subtotal Egresos:</td>
                              <td></td>
                              <td>{{ subtotalEgresos | currency }}</td>
                              <td></td>
                          </tr>
                          <tr>
                              <td colspan="3" class="text-end">Subtotal Deudas:</td>
                              <td></td>
                              <td></td>
                              <td>{{ subtotalDeudas | currency }}</td>
                          </tr>
                          <tr>
                              <td colspan="3" class="text-end">Total:</td>
                              <td>{{ subtotalIngresos - subtotalEgresos - subtotalDeudas | currency }}</td>
                              <td></td>
                              <td></td>
                          </tr>
                      </tfoot>
                  </table>
                  
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
